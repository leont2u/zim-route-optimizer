<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Zimbabwe Route Optimizer</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">

</head>
<body>
  <header>
    <h1>Zimbabwe Route Optimizer</h1>
    <div>Find the best route by distance, time, or cost</div>
  </header>

  <div class="container">
    <div class="card">
      <div class="section-title">Route Finder</div>
      <form method="post">
        <div class="form-grid">
          <div>
            <label>Start City</label>
            <select name="start_city" required>
              {% for city in cities %}
              <option value="{{ city }}" {% if route_info and route_info.path and route_info.path[0] == city %}selected{% endif %}>{{ city }}</option>
              {% endfor %}
            </select>
          </div>

          <div>
            <label>End City</label>
            <select name="end_city" required>
              {% for city in cities %}
              <option value="{{ city }}" {% if route_info and route_info.path and route_info.path[-1] == city %}selected{% endif %}>{{ city }}</option>
              {% endfor %}
            </select>
          </div>

          <div>
            <label>Optimize By</label>
            <select name="weight_type">
              <option value="distance">Distance</option>
              <option value="time">Time</option>
              <option value="cost">Cost</option>
            </select>
          </div>

          <div>
            <label>Mode</label>
            <select name="mode">
              <option value="sp">Shortest Path</option>
              <option value="tsp">TSP</option>
            </select>
          </div>

          <div style="align-self: end;">
            <button type="submit">Find Route</button>
          </div>
        </div>
      </form>
    </div>

    <div style="margin-top: 24px;" class="card">
      <div class="section-title">TSP & Constraints</div>
      <form method="post">
        <div class="form-grid">
          <div>
            <label>TSP Algorithm</label>
            <select name="tsp_algo">
              <option value="nearest">Nearest Neighbor</option>
              <option value="two_opt">Two-Opt</option>
              <option value="held_karp">Held-Karp</option>
              <option value="constrained">Constrained</option>
            </select>
          </div>

          <div>
            <label>Mandatory Stops</label>
            <input name="mandatory_cities" placeholder="Harare, Mutare" />
          </div>

          <div>
            <label>Max Budget</label>
            <input name="max_budget" type="number" step="any" placeholder="e.g., 1200" />
          </div>

          <div>
            <label>Max Time (hours)</label>
            <input name="max_time" type="number" step="any" placeholder="e.g., 20" />
          </div>
        </div>
        <div style="margin-top: 16px;">
          <input type="hidden" name="mode" value="tsp" />
          <button type="submit">Run TSP</button>
        </div>
      </form>
    </div>

    {% if route_info %}
    <div style="margin-top: 24px;" class="card">
      <div class="section-title">Results</div>

      {% if route_info.error %}
      <div class="meta" style="border-color:#fecaca; background:#fef2f2; color:#991b1b;">
        {{ route_info.error }}
      </div>
      {% else %}
      <div class="meta">
        <div><span class="pill">{{ route_info.algorithm }}</span></div>
        <div class="kvs">
          <div><strong>Distance:</strong> {{ route_info.distance }} ({{ route_info.weight_type }})</div>
          <div><strong>Nodes Visited:</strong> {{ route_info.nodes_visited }}</div>
          <div><strong>Exec Time:</strong> {{ route_info.execution_time }}s</div>
          <div><strong>Stops:</strong> {{ route_info.path|length }}</div>
        </div>
      </div>
      <div class="path">{{ route_info.path | join(' → ') }}</div>
      {% endif %}

      <div class="map" style="margin-top: 16px;">
        {% if map_html and route_info %}
        {{ map_html|safe }}
        {% else %}
        <div style="padding: 24px; color: #64748b;">Select two cities and click Find Route to see the map.</div>
        {% endif %}
      </div>
    </div>
    {% endif %}
  </div>

  <footer>
    © 2025 Zimbabwe Route Optimizer  Group 5
  </footer>
</body>
</html>
